from Crypto.Util.number import getPrime, bytes_to_long
import gmpy2
from secret import hint,flag

assert len(hint)==28

p, q = getPrime(1024), getPrime(1024)
N = p * q
# N = 13210885841475518997568732164505399160965975732709166440636514294147889012939962719747539825751923393125345841105194204835106865501597494306950242851021806919844457001207940087403826453676960820293604664852256329422339043270905696645969167335653171499672006516853649796861604166761519002960115698076234349938629174196811631219016260092670861554168242659812550025656836617235464100043662486564305360514744784304117455647758598410090081092904051134426154172210241012032835402789503490147182192969447649332989505033061036275185561204430838918866613413178664432425710430112085580833238357752115397317954683681495273481389
lam = gmpy2.lcm(p-1, q-1)
d1, d2 = getPrime(700), getPrime(700)
e1, e2 = gmpy2.invert(d1, lam), gmpy2.invert(d2, lam)
# e1 = 2362084139893405093100851500036437427130753588874770144214789282673606056995400452788220040281778791657867579436414252823552777228138008313512389117391660371862515728725314731064077161987981532020815534191123548980295455247064358562847786091773315905741298461223652815627950324240999370034314278563662587111397996345472564435937644492350734358340274983731113113635179437404528435163643061230423800728267343681110923935960537320270088154823842363204982299121314474873903268514696308154685325185965860497240479658442957806291665318879425962161464553028085194356710217166887400805442731868081113238642645694081223918279
# e2 = 3414563644994824673043321903579545055064146345197255378925441682500004270176946976155926310465466980633244227451321649151667496995568059258205501094869245772888762971415898595773497552721465370122131433357444025304164265928843912360131588986154074442926163483255945248639016376316121291379194754917958825314218152923102469383434911228730021468050093165348698614766633636600000928215593854869167057725013823299777115974128549538363855171997713965108293531424982357531477437917670830142806697234090847241145606725000986664742983223795093957257772115045975670612945728721064289031105561620681130223256874848014328627387
m = bytes_to_long(flag)
c = pow(m, 65537, N)
# c = 7509553860783555621436770331937084571808765391952325412927571489888110953335079989946907174565869802637698429436373777452178173489559054167708787358950733332569061899871857436220178404228920207316305775763298358672742916672692448339586826683320641684274797705468243189922260974401036329516370582452616835330578465913847623960113615530202243536961528874664359484225419012604926739741446652801517754617125097714308718696159416774441152786882175474276850952376624168400656872284235826980641374657158962776898393544419094412396806119989817549523336265300100681211520861433014873204547877014541979273900480702892070278171



#p1, q1 = getPrime(1024), getPrime(1024)
#N1 = p1 * q1
#p0 = p1 ^ (bytes_to_long(hint)<<444)
#assert N1==22752894188316360092540975721906836497991847739424447868959786578153887300450204451741779348632585992639813683087014583667437383610183725778340014971884694702424840759289252997193997614461702362265455177683286566007629947557111478254578643051667900283702126832059297887141543875571396701604215946728406574474496523342528156416445367009267837915658813685925782997542357007012092288854590169727090121416037455857985211971777796742820802720844285182550822546485833511721384166383556717318973404935286135274368441649494487024480611465888320197131493458343887388661805459986546580104914535886977559349182684565216141697843L
#assert p0==165268930359949857026074503377557908247892339573941373503738312676595180929705525120390798235341002232499096629250002305840384250879180463692771724228098578839654230711801010511101603925719055251331144950208399022480638167824839670035053131870941541955431984347563680229468562579668449565647313503239028017367L
